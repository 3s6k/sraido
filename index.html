<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title id="tab-title">無題のプレゼンテーション - Google スライド</title>
    <link id="favicon" rel="icon" href="https://ssl.gstatic.com/docs/presentations/images/favicon-5.ico">
    <style>
        :root { --bg: #f8f9fa; --nav-h: 65px; --accent: #ffbb00; }
        body, html { margin: 0; padding: 0; height: 100%; background: var(--bg); font-family: 'Arial', sans-serif; overflow: hidden; }

        /* スライド風ヘッダー */
        .slide-header {
            height: var(--nav-h); background: #fff; border-bottom: 1px solid #dadce0;
            display: flex; align-items: center; padding: 0 15px; gap: 15px;
        }
        .slide-logo { width: 30px; height: 30px; background: url('https://ssl.gstatic.com/docs/presentations/images/favicon-5.ico') no-repeat center/contain; }
        
        /* 科目切り替えボタン群 */
        .subject-btn {
            border: 1px solid #dadce0; background: #fff; padding: 5px 10px; 
            font-size: 12px; cursor: pointer; border-radius: 4px; color: #5f6368;
        }
        .subject-btn:hover { background: #f1f3f4; }

        /* 入力欄（目立たないように配置） */
        .input-box {
            background: #f1f3f4; border-radius: 4px; padding: 5px 10px;
            display: flex; align-items: center; flex-grow: 1; max-width: 400px; margin-left: 20px;
        }
        input { border: none; background: transparent; width: 100%; outline: none; font-size: 13px; }

        /* メインビュー */
        .viewer { height: calc(100vh - var(--nav-h)); width: 100%; background: #fff; }
        iframe { width: 100%; height: 100%; border: none; }
    </style>
</head>
<body>

<div class="slide-header">
    <div class="slide-logo"></div>
    <button class="subject-btn" onclick="fake('国語')">国</button>
    <button class="subject-btn" onclick="fake('数学')">数</button>
    <button class="subject-btn" onclick="fake('理科')">理</button>
    <button class="subject-btn" onclick="fake('社会')">社</button>
    <button class="subject-btn" onclick="fake('体育')">体</button>
    <button class="subject-btn" onclick="fake('英語')">英</button>

    <div class="input-box">
        <input type="text" id="target" placeholder="スライド内を検索（URL入力）" autocomplete="off">
    </div>
    <button style="background:var(--accent); border:none; color:white; padding:6px 15px; border-radius:4px; font-weight:bold; cursor:pointer;" onclick="launch()">実行</button>
</div>

<div class="viewer">
    <iframe id="main-frame" src="about:blank"></iframe>
</div>

<script>
    // ★KoyebのURLに書き換えてください
    const KOYEB_NODE = "https://あなたのアプリ名.koyeb.app/service/";

    // 1. プロキシ実行
    function launch() {
        let val = document.getElementById('target').value.trim();
        if (!val) return;
        if (!/^https?:\/\//i.test(val)) val = 'https://' + val;

        const frame = document.getElementById('main-frame');
        const encoded = btoa(val).replace(/\//g, '_').replace(/\+/g, '-').replace(/=/g, '');
        frame.src = KOYEB_NODE + encoded;
    }

    // 2. 科目偽装システム
    function fake(subject) {
        const titleTag = document.getElementById('tab-title');
        const faviconTag = document.getElementById('favicon');

        // 各科目に応じたアイコンの設定（適宜変更可能）
        const icons = {
            '国語': 'https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico', // Docs
            '数学': 'https://ssl.gstatic.com/docs/spreadsheets/images/favicon3.ico', // Sheets
            '理科': 'https://ssl.gstatic.com/docs/forms/device_home/android_192.png', // Forms
            '社会': 'https://www.google.com/favicon.ico', // Google
            '体育': 'https://www.wikipedia.org/static/favicon/wikipedia.ico', // Wikipedia
            '英語': 'https://ssl.gstatic.com/translate/favicon.ico' // Translate
        };

        // タイトルとアイコンを書き換え
        titleTag.innerText = `【${subject}】学習資料プロジェクト - Google スライド`;
        faviconTag.href = icons[subject] || 'https://ssl.gstatic.com/docs/presentations/images/favicon-5.ico';
    }

    // Enterキー対応
    document.getElementById('target').addEventListener('keypress', (e) => { if (e.key === 'Enter') launch(); });

    // Escキーで即座に初期状態（Googleスライド）へ
    document.addEventListener('keydown', (e) => {
        if (e.key === "Escape") {
            document.getElementById('tab-title').innerText = "無題のプレゼンテーション - Google スライド";
            document.getElementById('favicon').href = "https://ssl.gstatic.com/docs/presentations/images/favicon-5.ico";
            document.getElementById('main-frame').src = "about:blank";
        }
    });
</script>

</body>
</html>
